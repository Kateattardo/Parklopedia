<%- include('../partials/nav') %>


<div class="container-md">
  <% if (park.owner) {%>
      <small>Created by: <%= park.owner.name %></small>
  <% } %>
  <div class="row justify-content-between">
      <article class="col-5 border border-dark">
          <h1><%= park.name %></h1>
          <p><%= park.desc %></p>
          
          <div class="features border border-dark text-center">
              <h6>Features:</h6>
              <ul>
                  <li>Walking Trail: <%= park.walkingTrail ? 'Yes' : 'No' %></li>
                  <li>BBQ/Picnic Area: <%= park.bbqPicnic ? 'Yes' : 'No' %></li>
                  <li>Dog Run: <%= park.dogRun ? 'Yes' : 'No' %></li>
                  <li>Playground: <%= park.playground ? 'Yes' : 'No' %></li>
              </ul>
          </div>

          <% if (park.owner?._id.equals(user?._id)) {%>
              <div class="container-md">
                  <a href="/parks/edit/<%= park._id %>" class="btn btn-info m-3">
                      Edit <%= park.name %>
                  </a>
                  <form action="/parks/<%= park._id %>?_method=DELETE" method="POST">
                      <input type="submit" class="btn btn-danger m-3" value="Delete <%= park.name %>">
                  </form>
              </div>
          <% } %>
      </article>
  </div>
  <hr>
  <% if (user) { %>
      <div class="col-md-6">
          <form action="/comments/<%= park._id %>" method="POST">
              <fieldset>
                  <legend>Add Comment</legend>
                  <label class="form-label">comment:</label>
                  <input class="form-control mb-1" type="text" name="note">
                  <input type="submit" class="btn btn-success" value="add comment">
              </fieldset>
          </form>
      </div>
  <% } %>
  <hr>
  <div class="container-md">
        <% if (park?.comments?.length) { %>
       
          <!-- loop the comments and display -->
          <div class="container-sm m-4">
              <% park.comments.forEach(comm => {%>
                  <div class="card mb-4 shadow">
                      <div class="card-body">
                          <p><%= comm.review %></p>
                          <div class="d-flex justify-content-between">
                              <small>owner <%= comm %></small>
                              <% if (user && comm.owner?._id == user.id) { %>
                                  <form action="/comments/<%= park._id%>/<%= comm._id %>?_method=DELETE" method="POST">
                                      <input type="submit" class="btn btn-danger" value="X">
                                  </form>
                              <% } %>
                          </div>
                      </div>
                  </div>
              <% }) %>
          </div>
      <% } else { %>
          <p>No Comments Yet</p>
      <% } %>
  </div>
</div>

<%- include('../partials/footer') %>